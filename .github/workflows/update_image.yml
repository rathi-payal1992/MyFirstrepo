name: build image
 
on:
  workflow_dispatch:
 
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
 
      - name: create directory
        run: mkdir -p ~/image-cache
      - id: image-cache
        uses: actions/cache@v3
        with:
          path: ~/image-cache
          key: image-cache-${{ runner.os }}
 
      - name: docker pull
        if: steps.image-cache.outputs.cache-hit != 'true'
        run: |
          docker pull python:3.10.7-alpine
          docker save -o ~/image-cache/alpine.tar alpine
 
      - name: docker load
        if: steps.image-cache.outputs.cache-hit == 'true'
        run: docker load -i ~/image-cache/alpine.tar
 
      - name: 'Run tests'
        run: |
          cd ~/image-cache
          ls -ltr
